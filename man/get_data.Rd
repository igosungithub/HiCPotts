% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_data.R
\name{get_data}
\alias{get_data}
\title{Extract Hi‑C Bin Interactions with GC, Accessibility, and TE Counts}
\usage{
get_data(file_path, chr, start, end, resolution,
                 genome_package, acc_wig = NULL,
                 chain_file = NULL, te_granges = NULL)
}
\arguments{
\item{file_path}{Path to the Hi‑C file (\code{.hic}, \code{.cool}, or \code{.h5}).}

\item{chr}{Chromosome name (e.g. \code{"chr2L"}).}

\item{start}{1‑based start coordinate of the region.}

\item{end}{End coordinate of the region.}

\item{resolution}{Target bin size (bp).  If the native bins are smaller they will be merged;
if larger they will be sliced.}

\item{genome_package}{Name of a BSgenome package (e.g. \code{"BSgenome.Dmelanogaster.UCSC.dm6"}) from which
to extract DNA for GC calculations.}

\item{acc_wig}{(Optional) Path to a DNase‑I wig (bedGraph) file.  If provided together
with \code{chain_file}, accessibility scores will be lifted over,
averaged per bin, and returned.}

\item{chain_file}{(Optional) LiftOver chain file for mapping \code{acc_wig} coordinates.}

\item{te_granges}{(Optional) Either
\itemize{
  \item A path to a BED/GTF of TE annotations, which will be imported on‑the‑fly, or
  \item A \code{GRanges} object of TE loci.
}
Only TEs on \code{chr} are counted for each bin.}
}
\value{
A \code{data.frame} with one row per bin‑pair on the diagonal grid covering 
\code{[start,end]} at \code{resolution}, with columns:
\describe{
  \item{\code{start}}{Bin1 1‑based start.}
  \item{\code{end.i.}}{Bin1 end.}
  \item{\code{start.j.}}{Bin2 start.}
  \item{\code{end}}{Bin2 end.}
  \item{\code{chrom}}{Chromosome name.}
  \item{\code{GC}}{Combined GC fraction of the two bins.}
  \item{\code{ACC}}{Mean DNase‑I score per bin (or \code{NA} if none).}
  \item{\code{TES}}{Sum of TE overlaps in both bins (or \code{NA}).}
  \item{\code{interactions}}{Observed contact count (\code{0} if absent).}
}
}
\description{
Reads a Hi‑C contact matrix from a \code{.hic}, \code{.cool}, or \code{.h5} file,
subsets to a specified genomic region, rebins to a desired resolution (merging or
slicing as needed), and returns a complete grid of bin‑pair interactions.  For each
bin‑pair it computes:
\itemize{
  \item GC content from a BSgenome
  \item DNase‑I accessibility (if provided, lifted over)
  \item Transposable element (TE) overlap counts (if provided via BED/GTF or GRanges)
  \item Interaction counts
}
}
\examples{
\dontrun{
# 2kb bins over chr2L:1–40kb, with DHS and TE inputs
bb <- get_data(
  file_path      = "C:/Users/name/Desktop/hicTransform.h5",
  chr            = "chr2L",
  start          = 1,
  end            = 40000,
  resolution     = 2000,
  genome_package = "BSgenome.Dmelanogaster.UCSC.dm6",
  acc_wig        = "other/BG3.r2c.dhs.density.wig",
  chain_file     = "dm3ToDm6.over.chain",
  te_granges     = "dm6_TEs.gtf"
)
}

}
\seealso{
\code{\link{straw}}, \code{\link[rhdf5]{h5read}}, \code{\link{liftOver}}
}
