% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/potts_posterior.R
\name{pz_123}
\alias{pz_123}
\title{Posterior Function for the Potts Model}
\usage{
pz_123(z, sum_neighbours, y, pred_combined, chains, chain_gamma,
       x_vars, theta, size_chain, N, iter, dist)
}
\arguments{
\item{z}{A numeric \eqn{N \times N} matrix representing the component assignments for each site on the lattice.
Each element is a component label (e.g., 1, 2, or 3), indicating which mixture component that interaction currently belongs to.}

\item{sum_neighbours}{An \eqn{N \times N} numeric matrix representing the number of neighboring sites 
(up, down, left, right) that agree in state with each site. Typically computed by the function 
\code{Neighbours_combined()}.}

\item{y}{An \eqn{N \times N} numeric matrix of observed interaction counts (e.g., genomic interaction data).
Each element corresponds to the count observed at that site.}

\item{pred_combined}{An R function (passed from R to C++) that computes predicted values (linear predictors) 
for the specified component. This is often a reference to the \code{pred_combined()} function in R.}

\item{chains}{A \code{list} of parameter vectors (MCMC chains) for the model. Each element corresponds to 
a component and contains the parameters associated with that component.}

\item{chain_gamma}{A numeric vector (using ABC algorithm) for the interaction parameter \eqn{\gamma} that governs 
neighbor effects in the Potts model. The \code{iter}-th element of this vector is used in the calculation.}

\item{x_vars}{A list of covariates (sources of biases), each a nested structure as used by 
\code{pred_combined()}. These covariates are used to compute component-specific predicted values (\eqn{\lambda}).}

\item{theta}{A numeric scalar representing the zero-inflation parameter. Used when the distribution is 
Zero-Inflated Poisson (ZIP) or Zero-Inflated Negative Binomial (ZINB), typically for the first component.}

\item{size_chain}{An \eqn{3 \times M} matrix representing the MCMC draws of the size (overdispersion) parameter 
for Negative Binomial or Zero-Inflated Negative Binomial distributions. One row per component, and columns 
correspond to iterations. The value at \code{size_chain[comp - 1, iter]} is used for the specified iteration.}

\item{N}{An integer specifying the dimension of the lattice (\eqn{N \times N}).}

\item{iter}{An integer indicating which iteration of the MCMC chains (parameters, \eqn{\gamma}, size) to use 
in the calculation.}

\item{dist}{A character string specifying the distribution:
\itemize{
  \item \code{"Poisson"}: Poisson distribution
  \item \code{"NB"}: Negative Binomial distribution
  \item \code{"ZIP"}: Zero-Inflated Poisson distribution
  \item \code{"ZINB"}: Zero-Inflated Negative Binomial distribution
}}
}
\value{
A numeric \eqn{N \times N} matrix of log-posterior probabilities for each site for the specified component.
}
\description{
Computes log-posterior probabilities for each site in an \eqn{N \times N} lattice under the Potts model, 
combined with an interaction count model (e.g., genomic interactions). Incorporates mixture components, 
neighbor relationships, and distributional assumptions (Poisson, Negative Binomial, Zero-Inflated Poisson, 
Zero-Inflated Negative Binomial).
}
\details{
This function interfaces with C++ code to calculate log-posterior probabilities for an \eqn{N \times N} lattice 
under the Potts model. The model accounts for:
\enumerate{
  \item Component assignments (\code{z}) for each site.
  \item Observed interaction counts (\code{y}) from genomic data.
  \item Neighbor effects (\code{sum_neighbours}) weighted by \eqn{\gamma} (\code{chain_gamma}).
  \item Covariates (\code{x_vars}) used to compute predicted values (\eqn{\lambda}) via \code{pred_combined}.
  \item Distributional assumptions (\code{dist}: Poisson, NB, ZIP, or ZINB), with zero-inflation (\code{theta}) 
    for ZIP/ZINB (first component only) and overdispersion (\code{size_chain}) for NB/ZINB.
}
The \code{params} list bundles all necessary parameters, which are passed to the C++ function 
\code{_HMRFHiC_potts_posterior}. Probabilities are computed for each site, adjusted by neighbor effects 
using \eqn{\exp(\gamma \times \text{sum_neighbours})}, and returned as log-posteriors.
}
\examples{
#\donttest{
N <- 5
z <- matrix(sample(1:3, N * N, replace = TRUE), N, N)
x_vars <- list(cov1 = matrix(1, N, N), cov2 = matrix(2, N, N))
params <- list(
  chains = list(c(1, 2), c(3, 4), c(5, 6)),
  chain_gamma = rep(0.5, 100),
  theta = 0.2,
  size_chain = matrix(1, 3, 100),
  N = N,
  iter = 1,
  dist = "ZINB",
  y = matrix(rpois(N * N, 1), N, N),
  sum_neighbours = matrix(4, N, N),
  pred_combined = function(x, comp) rep(1, length(x[[1]]))
)
component <- 1
pz_vals <- pz_123(params, z, x_vars, component)
print(pz_vals)
#}

}
